<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd">
    
    <changeSet author="jayblanc" id="1">
        <createTable tableName="${instance}_MODELENTRY" schemaName="PUBLIC" >
            <column name="ID" type="VARCHAR(255)">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="AUTHOR" type="VARCHAR(255)"/>
            <column name="KEY" type="VARCHAR(255)"/>
            <column name="NAME" type="VARCHAR(255)"/>
            <column name="TYPE" type="VARCHAR(255)"/>
            <column name="BRANCHES" type="VARCHAR(5000)"/>
            <column name="DESCRIPTION" type="VARCHAR(5000)"/>
            <column name="VERSION" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="${instance}_MODELVERSION" schemaName="PUBLIC" >
            <column name="ID" type="VARCHAR(255)">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="BRANCHES" type="VARCHAR(5000)"/>
            <column name="AVAILABLELANGUAGES" type="VARCHAR(255)"/>
            <column name="DEFAULTLANGUAGE" type="VARCHAR(255)"/>
            <column name="COUNTERPARTS" type="VARCHAR(5000)"/>
            <column name="AUTHOR" type="VARCHAR(255)"/>
            <column name="PARENT" type="VARCHAR(255)"/>
            <column name="CHILD" type="VARCHAR(255)"/>
            <column name="SERIAL" type="VARCHAR(255)"/>
            <column name="STATUS" type="VARCHAR(255)"/>
            <column name="TYPE" type="VARCHAR(255)"/>
            <column name="ENTRY_ID" type="VARCHAR(255)"/>
            <column name="CREATIONDATE" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="MODIFICATIONDATE" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="VERSION" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addForeignKeyConstraint
                constraintName="${instance}_FK_MODELENTRY"
                baseColumnNames="ENTRY_ID"
                baseTableName="${instance}_MODELVERSION"
                baseTableSchemaName="PUBLIC"
                referencedColumnNames="ID"
                referencedTableName="${instance}_MODELENTRY"
                referencedTableSchemaName="PUBLIC"/>
        <createTable tableName="${instance}_MODELVERSION_CONTENT" schemaName="PUBLIC" >
            <column name="MODELVERSION_ID" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="CONTENT_KEY" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="AUTHOR" type="VARCHAR(255)"/>
            <column name="DATA" type="CLOB"/>
            <column name="DATACLASS" type="VARCHAR(2000)"/>
        </createTable>
        <addForeignKeyConstraint
                constraintName="${instance}_FK_MODELENTRY_CONTENT"
                baseColumnNames="MODELVERSION_ID"
                baseTableName="${instance}_MODELVERSION_CONTENT"
                baseTableSchemaName="PUBLIC"
                referencedColumnNames="ID"
                referencedTableName="${instance}_MODELVERSION"
                referencedTableSchemaName="PUBLIC"/>
        <addPrimaryKey
                constraintName="${instance}_PK_MODELVERSION_CONTENT_ID"
                columnNames="MODELVERSION_ID, CONTENT_KEY"
                schemaName="PUBLIC"
                tableName="${instance}_MODELVERSION_CONTENT"/>
        <createTable tableName="${instance}_RECORD" schemaName="PUBLIC" >
            <column name="ID" type="VARCHAR(255)">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="AUTHOR" type="VARCHAR(255)"/>
            <column name="BODYKEY" type="VARCHAR(255)"/>
            <column name="BODYSERIAL" type="VARCHAR(255)"/>
            <column name="INFOKEY" type="VARCHAR(255)"/>
            <column name="INFOSERIAL" type="VARCHAR(255)"/>
            <column name="PARENT" type="VARCHAR(255)"/>
            <column name="SERIAL" type="VARCHAR(255)"/>
            <column name="SUBJECT" type="VARCHAR(2000)"/>
            <column name="TRANSACTION" type="VARCHAR(255)"/>
            <column name="TYPE" type="VARCHAR(255)"/>
            <column name="VALUE" type="VARCHAR(255)"/>
            <column name="COMMENT" type="VARCHAR(5000)"/>
            <column name="MAILRECIPIENT" type="VARCHAR(255)"/>
            <column name="STATE" type="VARCHAR(255)"/>
            <column name="COLLECTIONMETHOD" type="VARCHAR(255)"/>
            <column name="CREATIONTIMESTAMP" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="EXPIRATIONTIMESTAMP" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="VERSION" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="${instance}_RECORD_ATTRIBUTES" schemaName="PUBLIC" >
            <column name="RECORD_ID" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="ATTRIBUTES_KEY" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="ATTRIBUTES" type="VARCHAR(5000)"/>
        </createTable>
        <addForeignKeyConstraint
                constraintName="${instance}_FK_RECORD_ATTRIBUTES_ID"
                baseColumnNames="RECORD_ID"
                baseTableName="${instance}_RECORD_ATTRIBUTES"
                baseTableSchemaName="PUBLIC"
                referencedColumnNames="ID"
                referencedTableName="${instance}_RECORD"
                referencedTableSchemaName="PUBLIC"/>
        <addPrimaryKey
                constraintName="${instance}_PK_RECORD_ATTRIBUTES_ID"
                columnNames="RECORD_ID, ATTRIBUTES_KEY"
                schemaName="PUBLIC"
                tableName="${instance}_RECORD_ATTRIBUTES"/>
        <createTable tableName="${instance}_SEQUENCE" schemaName="PUBLIC" >
            <column name="NAME" type="VARCHAR(255)">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="VERSION" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="VALUE" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="${instance}_SUBJECT" schemaName="PUBLIC" >
            <column name="ID" type="VARCHAR(255)">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="NAME" type="VARCHAR(2000)"/>
            <column name="EMAILADDRESS" type="VARCHAR(256)"/>
            <column name="CREATIONTIMESTAMP" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="${instance}_KEY" schemaName="PUBLIC" >
            <column name="ID" type="VARCHAR(255)">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="NAME" type="VARCHAR(255)"/>
            <column name="USERNAME" type="VARCHAR(255)"/>
            <column name="PASSWORD" type="VARCHAR(255)"/>
            <column name="ROLES" type="VARCHAR(255)"/>
            <column name="CREATIONDATE" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="${instance}_ACCESSLOG" schemaName="PUBLIC" >
            <column name="USERNAME" type="VARCHAR(255)">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="TIMESTAMP" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="${instance}_THINTOKEN" schemaName="PUBLIC" >
            <column name="ID" type="VARCHAR(255)">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="VALUE" type="VARCHAR(25000)"/>
            <column name="EXPIRES" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="${instance}_INSTANCE" schemaName="PUBLIC" >
            <column name="ID" type="VARCHAR(255)">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="KEY" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <createTable tableName="${instance}_NOTIFICATIONREPORT" schemaName="PUBLIC" >
            <column name="ID" type="VARCHAR(255)">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="VERSION" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="TRANSACTION" type="VARCHAR(255)"/>
            <column name="CREATIONTIMESTAMP" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="STATUS" type="VARCHAR(255)"/>
            <column name="TYPE" type="VARCHAR(255)"/>
            <column name="EXPLANATION" type="VARCHAR(2500)"/>
        </createTable>
    </changeSet>
    <changeSet author="jayblanc" id="2" context="demo">
        <loadData file="db/MODELENTRY.csv" separator="," tableName="${instance}_MODELENTRY" schemaName="PUBLIC"/>
        <loadData file="db/MODELVERSION.csv" separator="," tableName="${instance}_MODELVERSION" schemaName="PUBLIC"/>
        <loadData file="db/MODELVERSION_CONTENT.csv" separator="," tableName="${instance}_MODELVERSION_CONTENT" schemaName="PUBLIC">
            <column name="DATA" type="string"/>
        </loadData>
        <loadData file="db/SEQUENCE.csv" separator="," tableName="${instance}_SEQUENCE" schemaName="PUBLIC"/>
        <loadData file="db/SUBJECT.csv" separator="," tableName="${instance}_SUBJECT" schemaName="PUBLIC"/>
        <loadData file="db/RECORD.csv" separator="," tableName="${instance}_RECORD" schemaName="PUBLIC"/>
    </changeSet>
</databaseChangeLog>